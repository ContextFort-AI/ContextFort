/*! For license information please see popup.js.LICENSE.txt */
(()=>{function t(){var n,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function c(t,o,i,a){var c=o&&o.prototype instanceof s?o:s,l=Object.create(c.prototype);return e(l,"_invoke",function(t,e,o){var i,a,c,s=0,l=o||[],d=!1,f={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(t,e){return i=t,a=0,c=n,f.n=e,u}};function p(t,e){for(a=t,c=e,r=0;!d&&s&&!o&&r<l.length;r++){var o,i=l[r],p=f.p,v=i[2];t>3?(o=v===e)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=n):i[0]<=p&&((o=t<2&&p<i[1])?(a=0,f.v=e,f.n=i[1]):p<v&&(o=t<3||i[0]>e||e>v)&&(i[4]=t,i[5]=e,f.n=v,a=0))}if(o||t>1)return u;throw d=!0,e}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),a=l,c=v;(r=a<2?n:c)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,c)):f.n=c:f.v=c);try{if(s=2,i){if(a||(o="next"),r=i[o]){if(!(r=r.call(i,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,a<2&&(a=0)}else 1===a&&(r=i.return)&&r.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=n}else if((r=(d=f.n<0)?c:t.call(e,f))!==u)break}catch(t){i=n,a=1,c=t}finally{s=1}}return{value:r,done:d}}}(t,i,a),!0),l}var u={};function s(){}function l(){}function d(){}r=Object.getPrototypeOf;var f=[][i]?r(r([][i]())):(e(r={},i,function(){return this}),r),p=d.prototype=s.prototype=Object.create(f);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,e(t,a,"GeneratorFunction")),t.prototype=Object.create(p),t}return l.prototype=d,e(p,"constructor",d),e(d,"constructor",l),l.displayName="GeneratorFunction",e(d,a,"GeneratorFunction"),e(p),e(p,a,"Generator"),e(p,i,function(){return this}),e(p,"toString",function(){return"[object Generator]"}),(t=function(){return{w:c,m:v}})()}function e(t,n,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}e=function(t,n,r,o){function a(n,r){e(t,n,function(t){return this._invoke(n,r,t)})}n?i?i(t,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[n]=r:(a("next",0),a("throw",1),a("return",2))},e(t,n,r,o)}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,s=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function i(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var a=t.apply(e,n);function c(t){o(a,r,i,c,u,"next",t)}function u(t){o(a,r,i,c,u,"throw",t)}c(void 0)})}}document.addEventListener("DOMContentLoaded",i(t().m(function e(){var r,o,a,c,u,s;return t().w(function(e){for(;;)switch(e.n){case 0:s=function(){return(s=i(t().m(function e(){var r,i,u,s;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,chrome.tabs.query({active:!0,currentWindow:!0});case 1:r=t.v,i=n(r,1),u=i[0],console.log("[Popup] Active tab:",null==u?void 0:u.id,null==u?void 0:u.url),u&&(console.log("[Popup] Sending GET_AGENT_STATUS for tab:",u.id),chrome.runtime.sendMessage({type:"GET_AGENT_STATUS",tabId:u.id},function(t){console.log("[Popup] Received response:",t),t&&t.isAgentActive?(console.log("[Popup] Agent IS active! Showing button..."),a.classList.remove("hidden"),o.classList.remove("hidden"),t.swappedDomains&&t.swappedDomains.length>0&&(c.textContent="Domains: ".concat(t.swappedDomains.join(", ")),console.log("[Popup] Swapped domains:",t.swappedDomains))):(console.log("[Popup] Agent NOT active, hiding button"),a.classList.add("hidden"),o.classList.add("hidden"))})),t.n=3;break;case 2:t.p=2,s=t.v,console.error("[Popup] Failed to check agent status:",s);case 3:return t.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)},u=function(){return s.apply(this,arguments)},r=document.getElementById("open-dashboard-btn"),o=document.getElementById("restore-session-btn"),a=document.getElementById("agent-status"),c=document.getElementById("swapped-domains"),r.addEventListener("click",function(){chrome.tabs.create({url:chrome.runtime.getURL("dashboard/home/index.html")})}),o.addEventListener("click",i(t().m(function e(){var r,o,i,a;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,chrome.tabs.query({active:!0,currentWindow:!0});case 1:r=t.v,o=n(r,1),(i=o[0])&&chrome.runtime.sendMessage({type:"RESTORE_HUMAN_SESSION",tabId:i.id},function(t){t&&t.success&&window.close()}),t.n=3;break;case 2:t.p=2,a=t.v,console.error("Failed to restore session:",a);case 3:return t.a(2)}},e,null,[[0,2]])}))),u(),setInterval(u,2e3);case 1:return e.a(2)}},e)})))})();